<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Drone Telemetry Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Drone Telemetry Dashboard</h2>

<div id="loading">
  <p>データ読み込み中...</p>
</div>

<div id="data-section" style="display:none;">
  <h3>電力情報</h3>
  <table>
    <tr><th>項目</th><th>電圧 [V]</th><th>電流 [mA]</th></tr>
    <tr><td>負荷</td><td id="load-voltage"></td><td id="load-current"></td></tr>
    <tr><td>Liバッテリー</td><td id="li-voltage"></td><td id="li-current"></td></tr>
    <tr><td>ソーラー</td><td id="panel-voltage"></td><td id="panel-current"></td></tr>
  </table>

  <h3>GPS</h3>
  <p>緯度: <span id="gps-lat"></span></p>
  <p>経度: <span id="gps-lng"></span></p>
  <div id="map" style="width: 100%; height: 300px;"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script src="app.js"></script>

<script>
let map, marker;

function updateMap(lat, lng) {
  if (!map) {
    map = L.map('map').setView([lat, lng], 15);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

    marker = L.marker([lat, lng]).addTo(map);
  } else {
    marker.setLatLng([lat, lng]);
    map.setView([lat, lng]);
  }
}
</script>

</body>
</html>
